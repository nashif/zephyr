# Kconfig - x86 BSPs configuration options

#
# Copyright (c) 2014-2015 Wind River Systems, Inc.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions are met:
#
# 1) Redistributions of source code must retain the above copyright notice,
# this list of conditions and the following disclaimer.
#
# 2) Redistributions in binary form must reproduce the above copyright notice,
# this list of conditions and the following disclaimer in the documentation
# and/or other materials provided with the distribution.
#
# 3) Neither the name of Wind River Systems nor the names of its contributors
# may be used to endorse or promote products derived from this software without
# specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
# LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
# POSSIBILITY OF SUCH DAMAGE.
#

menu "BSP General Configuration"

choice
prompt "BSP Configuration"
default BSP_PCPENTIUM4

config BSP_ATOM_N28XX
	bool "Minimum configuration for ATOM N28XX BSP"
	select CPU_PENTIUM4
	select SHUTOFF_PIC
	select IOAPIC
	select LOAPIC
	select LOAPIC_TIMER
	select EOI_HANDLER_SUPPORTED
	select BOOTLOADER_UNKNOWN
	select EXTRA_SERIAL_PORT
	select SERIAL_INTERRUPT_LEVEL
	select CUSTOM_RANDOM_GENERATOR
	select BSP_GENERIC_PC

config BSP_PCMINUTEIA
	bool "Minimum configuration for MINUTE IA BSP"
	select CPU_MINUTEIA
	select PIC
	select PIT
	select BOI_HANDLER_SUPPORTED
	select EOI_HANDLER_SUPPORTED
	select BOOTLOADER_UNKNOWN
	select EXTRA_SERIAL_PORT
	select BSP_GENERIC_PC

config BSP_PCPENTIUM4
	bool "Minimum configuration for PENTIUM 4 BSP"
	select CPU_PENTIUM4
	select PIC
	select PIT
	select BOI_HANDLER_SUPPORTED
	select EOI_HANDLER_SUPPORTED
	select BOOTLOADER_UNKNOWN
	select EXTRA_SERIAL_PORT
	select BSP_GENERIC_PC

config BSP_QUARK
	bool "Minimum configuration for QUARK BSP"
	select CPU_MINUTEIA
	select IOAPIC
	select HPET_TIMER
	select EOI_HANDLER_SUPPORTED
	select BOOTLOADER_UNKNOWN
	select EXTRA_SERIAL_PORT
	select LINK_AUX_COMPILER_LIBS
	select DRV_NS16550
	select DRV_SERIAL
	select DRV_PCI

endchoice

config BSP_GENERIC_PC
	bool
	default n
	select DRV_TIMER
	select DRV_INTCTL
	select DRV_NS16550
	select DRV_SERIAL


menu "Intel Processor"

config CPU_MINUTEIA
	bool "Minute IA"
	help
	This option signifies the use of a CPU from the Minute IA family.

config CPU_PENTIUM4
	bool "Pentium 4"
	help
	This option signifies the use of a CPU from the Pentium 4 family.
endmenu

config ADVANCED_IDLE
	bool
	prompt "Advanced idle state"
	default n
	depends on ADVANCED_POWER_MANAGEMENT && ADVANCED_IDLE_SUPPORTED
	help
	This option enables the kernel to interface to a custom advanced idle
	power saving manager. This permits the system to enter a custom
	power saving state when the kernel becomes idle for extended periods,
	and then to restore the system to its previous state (rather than
	booting up from scratch) when the kernel is re-activated.

config ADV_IDLE_STACK_SIZE
	int
	prompt "Advanced idle state stack size"
	default 16
	depends on ADVANCED_IDLE
	help
	This option defines the size of the separate stack used during the
	system state check while the booting up. A separate stack is used
	to avoid memory corruption on the system re-activation from power
	down mode. The stack size must be large enough to hold the return
	address (4 bytes) and the _AdvIdleCheckSleep() stack frame.

config CPU_MIGHT_SUPPORT_CLFLUSH
	bool
	default n
	help
	If a BSP uses a processor that possibly implements CLFLUSH, change
	the default in that BSP's config file.

#FIXME This options is not being used in the current code base.
config CLFLUSH_INSTRUCTION_SUPPORTED
	bool
	prompt "CLFLUSH instruction supported" if CPU_MIGHT_SUPPORT_CLFLUSH
	depends on CPU_MIGHT_SUPPORT_CLFLUSH
	default n
	help
	Only enable this if the CLFLUSH instruction is supported, so that
	an implementation of _SysCacheFlush() that uses CLFLUSH is made
	available, instead of the one using WBINVD.

menu "Specific CPU Capability Support"

config ISA_IA32
	bool
	default y if CPU_MINUTEIA || CPU_PENTIUM4
	default n
	help
	This option signifies the use of a CPU based on the Intel IA-32
	instruction set architecture.

config HARDWARE_BP_SUPPORTED
	bool "Hardware BP supported"
	default y if ISA_IA32
	default n
	help
	This option signifies that the target supports hardware-based
	instruction breakpoints and/or data watchpoints.

config TICKLESS_IDLE_UNSUPPORTED
	prompt "Tickless Idle Unsupported"
	bool
	default n
	help
	This option signifies the use of an Intel CPU that lacks
	support for tickless idle.

config CMOV_UNSUPPORTED
	bool "CMOV Unsupported"
	default y if CPU_MINUTEIA
	default n
	help
	This option signifies the use of an Intel CPU that lacks support
	for the CMOV instruction.

config CPU_FLOAT_UNSUPPORTED
	bool "CPU float unsupported"
	default y if CPU_MINUTEIA
	default n
	select CPU_SSE_UNSUPPORTED
	help
	This option signifies the use of an Intel CPU that lacks support
	for floating point operations.

config CPU_SSE_UNSUPPORTED
	bool "CPU SSE unsupported"
	default n
	help
	This option signifies the use of an Intel CPU that lacks support
	for SSEx instructions (i.e. those which pre-date Pentium III).

config CACHE_LINE_SIZE
	int "Cache line size"
	default 64 if CPU_PENTIUM4
	default 0
	help
	Size in bytes of a CPU cache line.

endmenu

menu "Specific BSP Capability Support"
config DYNAMIC_INT_STUBS
	bool "Dynamic INT stubs"
	default n
	help
	This option allows a BSP's drivers to install interrupt handlers
	at run time, if desired. If not enabled, interrupt handlers can only
	be installed statically when the image is created.

config PROT_MODE_SWITCH_PROMPT
	bool "Prot Mode switch prompt"
	default n
	help
	This option allows users to select the value of the PROT_MODE_SWITCH
	configuration option.

config ADVANCED_IDLE_SUPPORTED
	bool "Advanced idle supported"
	default n
	help
	This option signifies that the target supports the ADVANCED_IDLE
	configuration option.

endmenu

config BOOTLOADER_UNKNOWN
	bool
	default n
	help
	This option signifies that the target has an unknown bootloader
	or that it supports multiple ways of booting and it isn't clear
	at build time which method is to be used. When this option is enabled
	the BSP may have to do extra work to ensure a propert startup.

menu "Boot Sequence Options"
depends on PROT_MODE_SWITCH_PROMPT

config PROT_MODE_SWITCH
	bool
	prompt "Switch to 32-bit protected mode when booting"
	default n
	depends on PROT_MODE_SWITCH_PROMPT
	help
	This option causes the kernel to transition from real mode (16-bit)
	to protected mode (32-bit) during its initial booting sequence.

config BOOT_A20_ENABLE
	bool "Boot A20 enable"
	depends on PROT_MODE_SWITCH
	default n
	help
	This option causes the A20 line to be enabled during the transition
	from real mode (16-bit) to protected mode (32-bit) during its initial
	booting sequence.

endmenu

config PIC
	bool "PIC (i8259)"
	default n
	depends on BSP_GENERIC_PC
	help
	This option selects legacy i8259 as the interrupt controller.

config SHUTOFF_PIC
	bool "Shutoff PIC"
	depends on !PIC
	default n
	help
	This option disables all interrupts on the PIC

endmenu
